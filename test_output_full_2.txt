
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/home/digni/Documents/Projects/tambola[39m

 [32mâœ“[39m src/features/game/lib/number-generator.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 111[2mms[22m[39m
 [31mâ¯[39m src/features/game/lib/validation.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 145[2mms[22m[39m
       [32mâœ“[39m should pass with valid data[32m 24[2mms[22m[39m
[31m       [31mÃ—[31m should fail when FULL_HOUSE is missing[39m[32m 36[2mms[22m[39m
       [32mâœ“[39m should fail with negative points[32m 3[2mms[22m[39m
       [32mâœ“[39m should pass with valid settings[32m 9[2mms[22m[39m
       [32mâœ“[39m should fail with invalid interval[32m 44[2mms[22m[39m
       [32mâœ“[39m should fail when minPlayers > maxPlayers[32m 7[2mms[22m[39m
       [32mâœ“[39m should fail when minPlayers < 2[32m 6[2mms[22m[39m
       [32mâœ“[39m should fail when maxPlayers > 75[32m 7[2mms[22m[39m
 [32mâœ“[39m src/app/api/games/[gameId]/start/route.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 111[2mms[22m[39m
 [32mâœ“[39m src/app/api/games/[gameId]/call-number/route.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 133[2mms[22m[39m
 [32mâœ“[39m src/features/game/lib/ticket-generator.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 830[2mms[22m[39m
     [33m[2mâœ“[22m[39m should generate robustly (bulk test) [33m 790[2mms[22m[39m
 [32mâœ“[39m src/app/api/games/[gameId]/join/route.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 153[2mms[22m[39m
 [32mâœ“[39m src/features/game/components/TicketDisplay.test.tsx [2m([22m[2m10 tests[22m[2m)[22m[33m 625[2mms[22m[39m
 [31mâ¯[39m src/features/game/components/LobbyPlayerList.test.tsx [2m([22m[2m7 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[33m 473[2mms[22m[39m
[31m     [31mÃ—[31m should render player list with initial players[39m[33m 332[2mms[22m[39m
[31m     [31mÃ—[31m should subscribe to Pusher channel on mount[39m[32m 33[2mms[22m[39m
[31m     [31mÃ—[31m should unsubscribe from Pusher channel on unmount[39m[32m 21[2mms[22m[39m
     [32mâœ“[39m should show empty state when no players[32m 19[2mms[22m[39m
[31m     [31mÃ—[31m should highlight current player[39m[32m 28[2mms[22m[39m
     [32mâœ“[39m should call setPlayers with initial players on mount[32m 12[2mms[22m[39m
[31m     [31mÃ—[31m should format join time correctly[39m[32m 16[2mms[22m[39m
[90mstderr[2m | src/features/game/components/GameList.test.tsx[2m > [22m[2mGameList Component[2m > [22m[2mshould render loading state initially
[22m[39mFailed to load games TypeError: Cannot read properties of undefined (reading 'ok')
    at fetchGames [90m(/home/digni/Documents/Projects/tambola/[39msrc/features/game/components/GameList.tsx:36:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m

[90mstderr[2m | src/features/game/components/GameList.test.tsx[2m > [22m[2mGameList Component[2m > [22m[2mshould render error state on fetch failure
[22m[39mFailed to load games Error: Network error
    at [90m/home/digni/Documents/Projects/tambola/[39msrc/features/game/components/GameList.test.tsx:42:7
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1653:37
    at Traces.$ [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1653:12[90m)[39m

 [32mâœ“[39m src/features/game/components/GameList.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[33m 1311[2mms[22m[39m
     [33m[2mâœ“[22m[39m should render games list when games are returned [33m 941[2mms[22m[39m
[90mstderr[2m | src/features/game/components/PlayerJoinForm.test.tsx[2m > [22m[2mPlayerJoinForm[2m > [22m[2mshould handle network error
[22m[39mJoin error: Error: Network error
    at [90m/home/digni/Documents/Projects/tambola/[39msrc/features/game/components/PlayerJoinForm.test.tsx:215:7
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1653:37
    at Traces.$ [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///home/digni/Documents/Projects/tambola/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1653:12[90m)[39m

 [32mâœ“[39m src/features/game/components/PlayerJoinForm.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[33m 1813[2mms[22m[39m
     [33m[2mâœ“[22m[39m should render join form with name input [33m 914[2mms[22m[39m
 [32mâœ“[39m src/features/game/components/HostStartButton.test.tsx [2m([22m[2m11 tests[22m[2m)[22m[33m 1515[2mms[22m[39m
     [33m[2mâœ“[22m[39m should render start button when user is host [33m 923[2mms[22m[39m
 [32mâœ“[39m src/app/api/games/route.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 47[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 6 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/features/game/components/LobbyPlayerList.test.tsx[2m > [22mLobbyPlayerList[2m > [22mshould render player list with initial players
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: 2 / 10. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div>[31m
      [36m<div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"flex items-center justify-between"[31m
        [36m>[31m
          [36m<h2>[31m
            [36m<svg[31m
              [33mdata-testid[31m=[32m"users-icon"[31m
            [36m/>[31m
            [0mPlayers[0m
          [36m</h2>[31m
          [36m<span>[31m
            [0m0[0m
            [0m / [0m
            [0m10[0m
          [36m</span>[31m
        [36m</div>[31m
      [36m</div>[31m
      [36m<div>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-muted-foreground text-center py-4"[31m
        [36m>[31m
          [0mWaiting for players to join...[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/features/game/components/LobbyPlayerList.test.tsx:[2m101:19[22m[39m
    [90m 99| [39m
    [90m100| [39m    [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m"Players"[39m))[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m101| [39m    [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m"2 / 10"[39m))[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m102| [39m  })[33m;[39m
    [90m103| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/6]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/features/game/components/LobbyPlayerList.test.tsx[2m > [22mLobbyPlayerList[2m > [22mshould subscribe to Pusher channel on mount
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'game-test-game-123' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/features/game/components/LobbyPlayerList.test.tsx:[2m113:40[22m[39m
    [90m111| [39m    )[33m;[39m
    [90m112| [39m
    [90m113| [39m    [34mexpect[39m(mockPusherClient[33m.[39msubscribe)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                                       [31m^[39m
    [90m114| [39m      [32m`game-[39m[36m${[39mmockGameId[36m}[39m[32m`[39m
    [90m115| [39m    )[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/6]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/features/game/components/LobbyPlayerList.test.tsx[2m > [22mLobbyPlayerList[2m > [22mshould unsubscribe from Pusher channel on unmount
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'player:joined' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/features/game/components/LobbyPlayerList.test.tsx:[2m133:32[22m[39m
    [90m131| [39m    [34munmount[39m()[33m;[39m
    [90m132| [39m
    [90m133| [39m    [34mexpect[39m(mockChannel[33m.[39munbind)[33m.[39m[34mtoHaveBeenCalledWith[39m([32m"player:joined"[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m134| [39m    [34mexpect[39m(mockPusherClient[33m.[39munsubscribe)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m135| [39m      [32m`game-[39m[36m${[39mmockGameId[36m}[39m[32m`[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/6]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/features/game/components/LobbyPlayerList.test.tsx[2m > [22mLobbyPlayerList[2m > [22mshould highlight current player
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: You. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div>[31m
      [36m<div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"flex items-center justify-between"[31m
        [36m>[31m
          [36m<h2>[31m
            [36m<svg[31m
              [33mdata-testid[31m=[32m"users-icon"[31m
            [36m/>[31m
            [0mPlayers[0m
          [36m</h2>[31m
          [36m<span>[31m
            [0m0[0m
            [0m / [0m
            [0m10[0m
          [36m</span>[31m
        [36m</div>[31m
      [36m</div>[31m
      [36m<div>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-muted-foreground text-center py-4"[31m
        [36m>[31m
          [0mWaiting for players to join...[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/features/game/components/LobbyPlayerList.test.tsx:[2m170:19[22m[39m
    [90m168| [39m    )[33m;[39m
    [90m169| [39m
    [90m170| [39m    [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m"You"[39m))[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m171| [39m
    [90m172| [39m    // Check that the current player's container has the highlight claâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/6]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/features/game/components/LobbyPlayerList.test.tsx[2m > [22mLobbyPlayerList[2m > [22mshould format join time correctly
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: /\d{1,2}:\d{2}/. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div>[31m
      [36m<div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"flex items-center justify-between"[31m
        [36m>[31m
          [36m<h2>[31m
            [36m<svg[31m
              [33mdata-testid[31m=[32m"users-icon"[31m
            [36m/>[31m
            [0mPlayers[0m
          [36m</h2>[31m
          [36m<span>[31m
            [0m0[0m
            [0m / [0m
            [0m10[0m
          [36m</span>[31m
        [36m</div>[31m
      [36m</div>[31m
      [36m<div>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-muted-foreground text-center py-4"[31m
        [36m>[31m
          [0mWaiting for players to join...[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m109:15[22m[39m
[36m [2mâ¯[22m src/features/game/components/LobbyPlayerList.test.tsx:[2m210:33[22m[39m
    [90m208| [39m    [90m// The time should be formatted as HH:MM[39m
    [90m209| [39m    // We can't test exact time due to timezone differences, but we caâ€¦
    [90m210| [39m    [35mconst[39m timeElements [33m=[39m screen[33m.[39m[34mgetAllByText[39m([36m/\d{1,2}:\d{2}/[39m)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m211| [39m    [34mexpect[39m(timeElements[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m212| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/6]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/features/game/lib/validation.test.ts[2m > [22mValidation Schemas[2m > [22mgamePatternSchema[2m > [22mshould fail when FULL_HOUSE is missing
[31m[1mAssertionError[22m: expected [Function] to throw error matching /Full House/i but got '[\n  {\n    "code": "custom",\n    "pâ€¦'[39m

[32m- Expected:[39m 
/Full House/i

[31m+ Received:[39m 
"[
  {
    \"code\": \"custom\",
    \"path\": [
      \"patterns\",
      \"patterns\"
    ],
    \"message\": \"FULL_HOUSE pattern must be enabled\"
  }
]"

[36m [2mâ¯[22m src/features/game/lib/validation.test.ts:[2m34:9[22m[39m
    [90m 32| [39m      [34mexpect[39m(() [33m=>[39m
    [90m 33| [39m        gamePatternSchema[33m.[39m[34mparse[39m({ patterns[33m:[39m invalidConfig })
    [90m 34| [39m      )[33m.[39m[34mtoThrow[39m([36m/Full House/i[39m)[33m;[39m
    [90m   | [39m        [31m^[39m
    [90m 35| [39m    })[33m;[39m
    [90m 36| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/6]âŽ¯[22m[39m


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m10 passed[39m[22m[90m (12)[39m
[2m      Tests [22m [1m[31m6 failed[39m[22m[2m | [22m[1m[32m89 passed[39m[22m[90m (95)[39m
[2m   Start at [22m 16:50:39
[2m   Duration [22m 12.87s[2m (transform 7.60s, setup 19.35s, import 12.72s, tests 7.27s, environment 56.63s)[22m

